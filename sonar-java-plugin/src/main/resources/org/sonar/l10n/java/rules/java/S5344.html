<p>Unresolved directive in rule.adoc - include::../summary.adoc[]</p>
<h2>Why is this an issue?</h2>
<p>Attackers who would get access to the stored passwords could reuse them without further attacks or with little additional effort.<br> Obtaining the
plaintext passwords, they could then gain unauthorized access to user accounts, potentially leading to various malicious activities.</p>
<p>Unresolved directive in rule.adoc - include::../impact.adoc[]</p>
<h2>How to fix it in Spring</h2>
<h3>Code examples</h3>
<h4>Noncompliant code example</h4>
<p>The following code is vulnerable because it uses a legacy digest-based password encoding that is not considered secure.</p>
<pre data-diff-id="1" data-diff-type="noncompliant">
@Autowired
public void configureGlobal(AuthenticationManagerBuilder auth, DataSource dataSource) throws Exception {
  auth.jdbcAuthentication()
    .dataSource(dataSource)
    .usersByUsernameQuery("SELECT * FROM users WHERE username = ?")
    .passwordEncoder(new StandardPasswordEncoder()); // Noncompliant
}
</pre>
<h4>Compliant solution</h4>
<pre data-diff-id="1" data-diff-type="compliant">
@Autowired
public void configureGlobal(AuthenticationManagerBuilder auth, DataSource dataSource) throws Exception {
  auth.jdbcAuthentication()
    .dataSource(dataSource)
    .usersByUsernameQuery("SELECT * FROM users WHERE username = ?")
    .passwordEncoder(new BCryptPasswordEncoder());
}
</pre>
<h3>How does this work?</h3>
<p>Unresolved directive in rule.adoc - include::../common/fix/password-hashing.adoc[]</p>
<p>In the previous example, the <code>BCryptPasswordEncoder</code> is a password hashing function in Java that is designed to be secure and resistant
to various types of attacks, including brute-force and rainbow table attacks. It is slow, adaptative, and automatically implements a salt.</p>
<p>Unresolved directive in rule.adoc - include::../common/fix/plaintext-password.adoc[]</p>
<h2>Resources</h2>
<h3>Documentation</h3>
<ul>
  <li> Spring Framework Security Documentation - <a
  href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/crypto/bcrypt/BCryptPasswordEncoder.html">Class
  BCryptPasswordEncoder</a> </li>
  <li> OWASP CheatSheet - <a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html">Password Storage Cheat Sheet</a>
  </li>
</ul>
<p>Unresolved directive in rule.adoc - include::../common/resources/standards.adoc[]</p>

